include:
  - path: prep/compose.yml
  # - path: docker/compose.utils.yml

services:
  fms: 
    profiles:
      - live
    image: ${IMAGE:-fms}:$TAG_PREFIX${TAG_PREFIX:+-}$VERSION-u$UBUNTU${TAG_SUFFIX:+-}$TAG_SUFFIX
    container_name: fms
    hostname: fms
    privileged: true
    stop_grace_period: 0s
    ports:
      # - 80:80
      # - 443:443
      # - 2399:2399
      - 5003:5003
      # - 16001:16001
    volumes:
      - fms:/opt/FileMaker/FileMaker Server
      - devin:/opt/Devin
      - files:/opt/FileMaker/FileMaker Server/Data/Databases/RC_Data_FMS
      - backups:/opt/FileMaker/FileMaker Server/Data/Backups
      - xlones:/opt/FileMaker/FileMaker Server/Data/ClonesOnly
      # Sync time with host
      - /etc/localtime:/etc/localtime:ro

volumes:
  fms:
    external: true
    name: ${FMS_VOL:-fms}
  devin:
    external: true
    name: ${DEVIN_VOL:-devin}
  files:
    external: true
    name: ${FILES_VOL:-fms_files}
  backups:
    external: true
    name: ${FILES_VOL:-fms_backups}
  clones:
    external: true
    name: ${FILES_VOL:-fms_clones}